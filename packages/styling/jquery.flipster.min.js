(function(a){a.fn.flipster=function(b){var e={itemContainer:"ul",itemSelector:"li",style:"coverflow",start:"center",enableKeyboard:true,enableMousewheel:true,enableTouch:true,enableNav:false,enableNavButtons:false,onItemSwitch:function(){},disableRotation:false};var c=a.extend({},e,b);var d=a(window);return this.each(function(){var v=a(this);var x;var h;var k;var r;var g=0;var o=0;var q=0;var l;var f;function m(){q=0;}function w(){x.height(u());v.css("height","auto");if(c.style==="carousel"){x.width(h.width());}}function u(){var z=0;h.each(function(){if(a(this).height()>z){z=a(this).height();}});return z;}function p(){if(c.enableNav&&h.length>1){var A=[],C=[],B=[];h.each(function(){var F=a(this).data("flip-category"),G=a(this).attr("id"),E=a(this).attr("title");if(typeof F!=="undefined"){if(a.inArray(F,A)<0){A.push(F);B[F]='<li class="flip-nav-category"><a href="#" class="flip-nav-category-link" data-flip-category="'+F+'">'+F+'</a>\n<ul class="flip-nav-items">\n';}}if(a.inArray(G,C)<0){C.push(G);link='<a href="#'+G+'" class="flip-nav-item-link">'+E+"</a></li>\n";if(typeof F!=="undefined"){B[F]=B[F]+'<li class="flip-nav-item">'+link;}else{B[G]='<li class="flip-nav-item no-category">'+link;}}});navDisplay='<ul class="flipster-nav">\n';for(var z in A){B[A[z]]=B[A[z]]+"</ul>\n</li>\n";}for(var D in B){navDisplay+=B[D];}navDisplay+="</ul>";k=a(navDisplay).prependTo(v);r=k.find("a").on("click",function(F){var E;if(a(this).hasClass("flip-nav-category-link")){E=h.filter("[data-flip-category='"+a(this).data("flip-category")+"']");}else{E=a(this.hash);}if(E.length){j(E);F.preventDefault();}});}}function n(){if(c.enableNav&&h.length>1){currentItem=a(h[g]);k.find(".flip-nav-current").removeClass("flip-nav-current");r.filter("[href='#"+currentItem.attr("id")+"']").addClass("flip-nav-current");r.filter("[data-flip-category='"+currentItem.data("flip-category")+"']").parent().addClass("flip-nav-current");}}function t(){if(c.enableNavButtons&&h.length>1){v.find(".flipto-prev, .flipto-next").remove();v.append("<a href='#' class='flipto-prev'>Previous</a> <a href='#' class='flipto-next'>Next</a>");v.children(".flipto-prev").on("click",function(z){j("left");z.preventDefault();});v.children(".flipto-next").on("click",function(z){j("right");z.preventDefault();});}}function y(){var L=a(h[g]).addClass("flip-current");h.removeClass("flip-prev flip-next flip-current flip-past flip-future no-transition");if(c.style==="carousel"){h.addClass("flip-hidden");var z=a(h[g+1]),J=a(h[g+2]),K=a(h[g-1]),N=a(h[g-2]);if(g===0){K=h.last();N=K.prev();}else{if(g===1){N=h.last();}else{if(g===h.length-2){J=h.first();}else{if(g===h.length-1){z=h.first();J=a(h[1]);}}}}J.removeClass("flip-hidden").addClass("flip-future");N.removeClass("flip-hidden").addClass("flip-past");z.removeClass("flip-hidden").addClass("flip-next");K.removeClass("flip-hidden").addClass("flip-prev");}else{var I=L.outerWidth()/2;var B=0;var G=x.width();var D=L.outerWidth();var C=(h.index(L)*D)/2+I/2;h.removeClass("flip-hidden");for(i=0;i<h.length;i++){var A=a(h[i]);var H=A.outerWidth();if(i<g){A.addClass("flip-past").css({"z-index":i,left:(i*H/2)+"px"});}else{if(i>g){A.addClass("flip-future").css({"z-index":h.length-i,left:(i*H/2)+I+"px"});}}}L.css({"z-index":h.length+1,left:C+"px"});B=(C+(D/2))-(G/2);var F=-1*(B)+"px";if(f){var M=a(".flip-past");var E=a(".flip-future");a(".flip-current").css("zoom","1.0");for(i=0;i<M.length;i++){a(M[i]).css("zoom",(100-((M.length-i)*5)+"%"));}for(i=0;i<E.length;i++){a(E[i]).css("zoom",(100-((i+1)*5)+"%"));}x.animate({left:F},333);}else{x.css("left",F);}}L.addClass("flip-current").removeClass("flip-prev flip-next flip-past flip-future flip-hidden");w();n();c.onItemSwitch.call(this);}function j(z){if(h.length>1){if(z==="left"){if(g>0){g--;}else{g=h.length-1;}}else{if(z==="right"){if(g<h.length-1){g++;}else{g=0;}}else{if(typeof z==="number"){g=z;}else{g=h.index(z);}}}y();}}function s(){v.addClass("flipster flipster-active flipster-"+c.style).css("visibility","hidden");if(c.disableRotation){v.addClass("no-rotate");}x=v.find(c.itemContainer).addClass("flip-items");h=x.find(c.itemSelector).addClass("flip-item flip-hidden").wrapInner("<div class='flip-content' />");var B=("\v"==="v");var z=document.createElement("b");z.innerHTML="<!--[if IE 9]><i></i><![endif]-->";var A=z.getElementsByTagName("i").length===1;if(B||A){f=true;x.addClass("compatibility");}p();t();if(c.start&&h.length>1){if(c.start==="center"){if(!h.length%2){g=h.length/2+1;}else{g=Math.floor(h.length/2);}}else{g=c.start;}}w();v.hide().css("visibility","visible").fadeIn(400,function(){y();});d.resize(function(){w();y();});h.on("click",function(C){if(!a(this).hasClass("flip-current")){C.preventDefault();}j(h.index(this));});if(c.enableKeyboard&&h.length>1){d.on("keydown.flipster",function(D){q++;if(q%7!==0&&q!==1){return;}var C=D.which;if(C===37){D.preventDefault();j("left");}else{if(C===39){D.preventDefault();j("right");}}});d.on("keyup.flipster",function(C){q=0;});}if(c.enableMousewheel&&h.length>1){v.on("mousewheel.flipster",function(C){l=window.setTimeout(m,500);q++;if(q%4!==0&&q!==1){return;}window.clearTimeout(l);if(C.originalEvent.wheelDelta/120>0){j("left");}else{j("right");}C.preventDefault();});}if(c.enableTouch&&h.length>1){v.on("touchstart.flipster",function(C){o=C.originalEvent.targetTouches[0].screenX;});v.on("touchmove.flipster",function(E){E.preventDefault();var C=E.originalEvent.targetTouches[0].screenX;var D=C-o;if(D>h[0].clientWidth/1.75){j("left");o=C;}else{if(D<-1*(h[0].clientWidth/1.75)){j("right");o=C;}}});v.on("touchend.flipster",function(C){o=0;});}}if(!v.hasClass("flipster-active")){s();}});};})(jQuery);
